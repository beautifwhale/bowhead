language: node_js

node_js: 10

cache:
  yarn: true
  directories:
    - "node_modules"

# configuration
install: 
  - echo "//registry.npmjs.org/:_authToken=${NPM_TOKEN}" > ~/.npmrc  
  - git config user.email "davidmortonmail@gmail.com"
  - git config user.name "daithimorton"
  - git remote set-url origin https://${GITHUB_TOKEN}@github.com/daithimorton/bowhead.git
  - git checkout master

stages:
  # - build
  - test
  - publish

jobs:  
  include:
    # - stage: build
    #   script:
    #     - yarn build:cra-template-bowhead
    #   after_success:
    #     - git status        
    #     - git add .
    #     - git commit -m "chore(*) TravisCI update [skip ci]"
    #     - git push origin HEAD:master
    - stage: test      
      script: skip
    - stage: publish
      script: yarn build:cra-template-bowhead
      deploy:
        - provider: script
          script: yarn release          
          skip_cleanup: true
          on:
            branch: master